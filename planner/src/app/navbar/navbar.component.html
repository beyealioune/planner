<div>
  <!-- NavBar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="#">MonApp</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" routerLink="/navbar">Home</a></li>
          <li class="nav-item"><a class="nav-link" routerLink="/planning">Planning</a></li>
          <li class="nav-item"><a class="nav-link" routerLink="/contact">Contact</a></li>
          <li class="nav-item"><a class="nav-link" routerLink="/profile">Mon Profil</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Contenu Principal -->
  <div class="container mt-5 d-flex flex-column align-items-center">
    <!-- Profil -->
    <div class="text-center mb-5">
      <img src="profile.jpg" alt="Photo de profil" class="rounded-circle profile-pic mb-3" />
      <h3 class="mb-2">Mes disponibilités</h3>
      <button class="btn btn-primary">Voir mon emploi du temps</button>
    </div>

    <!-- Abonnés -->
    <div class="text-center">
      <h5>Mes abonnés</h5>
      <div class="d-flex flex-wrap justify-content-center mt-4 abonne-list">
        <mat-card
          *ngFor="let user of allUsers"
          class="m-2 text-center"
          (click)="toggleSubscription(user)"
          style="cursor: pointer; width: 180px;"
        >
          <img
            [src]="'/assets/profiles/' + user.id + '.jpg'"
            alt="Photo"
            class="abonne-pic mx-auto mt-2"
          />
          <div class="mt-2">
            <h6>{{ user.username }}</h6>
            <button mat-stroked-button color="primary">
              {{ isSubscribed(user) ? 'Abonné' : 'S’abonner' }}
            </button>
          </div>
        </mat-card>
      </div>
    </div>

    <!-- Disponibilités en commun -->
    <div *ngIf="commonAvailabilities.length > 0" class="text-center mt-4 w-100">
      <h5>Disponibilités en commun</h5>
      <ul class="list-group mx-auto" style="max-width: 600px;">
        <li *ngFor="let dispo of commonAvailabilities" class="list-group-item">
          {{ dispo.date }} - {{ dispo.isAvailable ? 'Disponible' : 'Indisponible' }}
        </li>
      </ul>
    </div>

    <!-- Bouton afficher / masquer -->
    <div class="text-center mt-4">
      <button class="btn btn-outline-primary" (click)="loadAllCommonAvailabilities()">
        {{ showSubscriptions ? 'Masquer' : 'Voir' }} les disponibilités de mes abonnements
      </button>
    </div>

    <!-- Liste des disponibilités abonnements -->
    <div *ngIf="showSubscriptions" class="mt-4 w-100">
      <h5 class="text-center">Disponibilités de mes abonnements</h5>
      <div class="row justify-content-center">
        <div class="col-md-6" *ngFor="let item of subscriptionsAvailability">
          <div class="card mb-3 shadow-sm">
            <div class="card-header bg-light"><strong>{{ item.username }}</strong></div>
            <ul class="list-group list-group-flush">
              <li *ngFor="let dispo of item.availabilities" class="list-group-item">
                {{ dispo.date }} - {{ dispo.isAvailable ? 'Disponible' : 'Indisponible' }}
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Planning -->
  <app-planning></app-planning>
</div>
